<div class="modal">
  <div class="modal-content">
    <button class="close-button" (click)="cancel()">X</button>
    <h2>Create Nutritional Plan</h2>

    <form [formGroup]="planForm" (ngSubmit)="save()">
      <div *ngIf="loadError" class="error">{{ loadError }}</div>

      <div class="form-group">
        <label for="client">Client</label>
        <select id="client" formControlName="clientId">
          <option value="">Select Client</option>
          <option *ngFor="let c of clients" [value]="c.id">{{ c.fullName }}</option>
        </select>
        <div *ngIf="planForm.controls['clientId'].invalid && planForm.controls['clientId'].touched" class="error">
          Client is required
        </div>
      </div>

      <div class="form-group">
        <label for="nutritionist">Nutritionist</label>
        <select id="nutritionist" formControlName="nutritionistId">
          <option value="">Select Nutritionist</option>
          <option *ngFor="let n of nutritionists" [value]="n.id">{{ n.fullName }}</option>
        </select>
        <div *ngIf="planForm.controls['nutritionistId'].invalid && planForm.controls['nutritionistId'].touched" class="error">
          Nutritionist is required
        </div>
      </div>

      <div class="form-group">
        <label for="details">Plan Details</label>
        <textarea id="details" formControlName="planDetails"></textarea>
        <div *ngIf="planForm.controls['planDetails'].invalid && planForm.controls['planDetails'].touched" class="error">
          Plan details are required (minimum 10 characters)
        </div>
      </div>

      <button type="submit" [disabled]="isSubmitting">
        {{ isSubmitting ? 'Saving...' : 'Save Plan' }}
      </button>
    </form>
  </div>
</div>
